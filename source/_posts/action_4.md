---
title: Learning Spatiotemporal Features with 3D Convolutional Networks (ICCV 2015)
date: 2019-10-15 20:00:29
tags:
- 动作识别
- C3D
---
&emsp;&emsp;这篇文章的贡献点有三个：使用3D卷积网络来提取时空特征；使用3\*3\*3的小卷积核组成网络结构，识别效果最好；提出的C3D网络在动作识别中取得了state-of-the-art的效果，计算简单，容易训练和使用。
&emsp;&emsp;一个有效的视频描述子应具备以下属性：首先描述子应该是通用的，这样才能表示不同类型的视频，同时具有区分性；其次，描述子应该紧凑，因为我们处理的是上百万的视频资源，一个紧凑的描述子能帮助处理、检索伸缩性更强的任务；此外，计算方法应该是高效的；最后，应该能很方便地应用，与使用复杂的特征编码方法和分类器不同，一个好的描述子应该在很简单的模型（如线性分类器）中的效果都能很好。
&emsp;&emsp;尽管以前已经有学者应用3D卷积网络，但是，并没有一篇论文在大规模监督学习训练数据库和深度网络结构组合后，在不同类型的视频分析人物中取得最好的效果。从3D卷积网络得到的特征封装了视频中关于物体、场景和动作的信息，这使得在应对不同的任务时，不需要进行模型的fine-tune。C3D拥有一个好的描述子该有的属性。
![](/images/C3D/compare.png "C3D与发表的最好的方法的比较")
&emsp;&emsp;之前的3D卷积方法是先检测人，再使用跟踪的方法将人分割出来，而这片论文的方法是将整个视频帧作为输入，不需要任何预处理，容易扩展到大的数据库。
# 3D卷积网络
## 3D卷积和池化
&emsp;&emsp;在一张图片上应用2D卷积，得到的结果是一个图片；在许多图片上应用2D卷积，得到的还是一张图片，因此，2D卷积丢失了输入信号的时序信息。在之前的Large-scale Video Classification with Convolutional Neural Networks论文中，只有Slow Fusion模型使用了3D卷积，我们相信这也是为何这个方法能完胜其他网络的关键原因，但它在第三个卷积层之后仍旧缺少所有的时序信息。
![](/images/C3D/convolution.png "2D卷积核3D卷积对比")
&emsp;&emsp;为了简便，之后的视频片段表示为c\*l\*h\*w，其中，c是通道数，l是视频帧的数量，h和w分别是高和宽。3D卷积核表示为d\*k\*k，d是卷积核时间长度，k是空间尺寸。
&emsp;&emsp;由于在大规模数据库上进行训练是非常耗时的，所以现在一个中等规模的数据库UCF-101上训练，找到最好的模型结构，输入全部缩放成128\*171，这个尺寸差不多是UCF-101中视频尺寸的一半，视频分成没有重叠的16帧的片段clip，作为网络的输入，所以输入的维度是3\*16\*128\*171，同时，也是用jittering的方法，通过使用随机的crop，在训练阶段crop出3\*16\*112\*112的区域。网络包括5个卷积层和5个池化层（每个卷积之后都有一个池化），2个全连接层和一个softmax层，5个卷积层的滤波器个数分别是64,128,256,256,256，所有的卷积层都使用合适的padding（时间空间都有），stride=1，所以从输入到输出，尺寸都没有变化。第一个池化层的尺寸是1\*2\*2，为了不过早合并时间信号，也为了满足clip的长度为16，这样我们就可以在时间维度以factor=2，在时间信号消失前，将pool操作进行4次，两个全连接层的神经元个数是2048，训练时从头开始训练，mini-batch=30个clip，lr=0.003，每4个epoch缩小为原来的1/10，经过16个epoch后停止训练。
## 探索时间深度
&emsp;&emsp;在这篇论文中，我们感兴趣的是如何通过深度网络集成时间信息，为了探索一个好的3D卷积结构，我们只改变卷积核的时间长度d，其他保持不变，试验两种结构：均匀的时间深度：所有的卷积层有相同的卷积核时间深度；改变时间深度：不同层的卷积核时间深度不同。对于第一种，试验4种网络，卷积核的时间深度分别是1,3,5,7，并将这种网络命名为depth-d，其中depth-1就相当于在分离的帧中使用2D卷积；对于第二种，我们试验2种网络：时间深度增加3-3-5-5-7，和时间深度减少7-5-5-3-3。所有网络在最后的pooling层有相同尺寸的输出，所以对于全连接层有相同数量的参数，参数的数量只在卷积层不同（因为卷积核时间深度不同），相比于全连接层上百万的参数，这些参数的不同的影响微乎其微。实验结果如下图所示：
![](/images/C3D/3D-convolution.png "3D卷积核时间深度的研究")
&emsp;&emsp;从结果中我们可以看出，3\*3\*3是效果最好的卷积核，这个发现与2D卷积网络中的发现是类似的；此外，3D卷积网络普遍比2D卷积网络的效果好。
## 时空特征学习
### 网络结构
&emsp;&emsp;对于大规模数据库，可以训练一个基于3\*3\*3卷积核的深度3D卷积网络，由8个卷积层，5个pooling层，2个全连接层和一个softmax输出层组成，网络结构如下图所示：
![](/images/C3D/C3D.png "C3D网络结构")
&emsp;&emsp;所有的卷积核都是3\*3\*3，stride=1\*1\*1，所有的3D pooling层都是2\*2\*2，stride=2\*2\*2，除了pool的kernel_size=1\*2\*2，stride=1\*2\*2，全连接层有4096个神经元。
### 数据库
&emsp;&emsp;为了学习时空特征，我们在现在最大的视频分类数据库——Sports-1M上训练，这个数据库包括110万个体育视频，每个视频属于487类中的一种，与UCF-101相比，这个数据库有5倍的动作种类和100倍的视频资源。
### 训练
&emsp;&emsp;
&emsp;&emsp;
&emsp;&emsp;
&emsp;&emsp;
&emsp;&emsp;

